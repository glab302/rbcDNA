Genomedir=/Database/hg38;
Genome=GRCh38;

sample="GLPLC1 GLPLC2 GLPLC3 GLPLC4 GLPLC5 GLPLC6 GLPLC7 GLPLC8 GLPLC9 GLPLC10 GLPLC11 GLPLC12 GLPLC13 GLPLC14 GLPLC15 GLPLC16 GLPLC17 GLPLC18 GLPLC19 GLPLC20 GLPLC21 GLPLC22 GLPLC23 GLPLC24 GLPLC25 GLPLC26 GLPLC27 GLPLC28 GLPLC29 GLPLC30 GLPLC31 GLPLC32 GLPLC33 GLPLC34 GLPLC35 GLPLC36 GLPLC37 GLPLC38 GLPLC39 GLPLC40 GLPLC41 GLPLC42 GLPLC43 GLPLC44 GLPLC45 GLPLC46 GLPLC47 GLPLC48 GLPLC49 GLPLC50 GLPLC51 GLPLC52 GLPLC53 GLPLC54 GLPLC55 GLPLC56 GLPLC57 GLPLC58 GLPLC59 GLPLC60 GLPLC61 GLPLC62 GLPLC63 GLPLC64 GLPLC65 GLPLC66 GLPLC67 GLPLC68 GLPLC69 GLPLC70 GLPLC71 GLPLC72 GLPLC73 GLPLC74 GLPLC75 GLPLC76 GLPLC77 GLPLC78 GLPLC79 GLPLC80 GLPLC81 GLPLC82 GLPLC83 GLPLC84 GLPLC85 GLPLC86 GLPLC87 GLPLC88 GLPLC89 GLPCRC1 GLPCRC2 GLPCRC3 GLPCRC4 GLPCRC5 GLPCRC6 GLPCRC7 GLPCRC8 GLPCRC9 GLPCRC10 GLPCRC11 GLPCRC12 GLPCRC13 GLPCRC14 GLPCRC15 GLPCRC16 GLPCRC17 GLPCRC18 GLPCRC19 GLPCRC20 GLPCRC21 GLPCRC22 GLPCRC23 GLPCRC24 GLPCRC25 GLPCRC26 GLPCRC27 GLPCRC28 GLPCRC29 GLPCRC30 GLPCRC31 GLPCRC32 GLPCRC33 GLPCRC34 GLPCRC35 GLPCRC36 GLPCRC37 GLPCRC38 GLPCRC39 GLPCRC40 GLPCRC41 GLPCRC42 GLPCRC43 GLPCRC44 GLPCRC45 GLPCRC46 GLPCRC47 GLPCRC48 GLPCRC49 GLPCRC50 GLPCRC51 GLPCRC52 GLPCRC53 GLPCRC54 GLPCRC55 GLPCRC56 GLPCRC57 GLPCRC58 GLPCRC59 GLPCRC60 GLPCRC61 GLPCRC62 GLPCRC63 GLPCRC64 GLPCRC65 GLPCRC66 GLPCRC67 GLPCRC68 GLPCRC69 GLPCRC70 GLPCRC71 GLPCRC72 GLPCRC73 GLPCRC74 GLPCRC75 GLPCRC76 GLPCRC77 GLPCRC78 GLPCRC79 GLPCRC80 GLPCRC81 GLPCRC82 GLPCRC83 GLPCRC84 GLPCRC85 GLPCRC86 GLPCRC87 GLPCRC88 GLPCRC89 GLPCRC90 GLPCRC91 GLPCRC92 GLPCRC93 GLPCRC94 GLPCRC95 GLPCRC96 GLPCRC97 GLPCRC98 GLPCRC99 GLPHCC1 GLPHCC2 GLPHCC3 GLPHCC4 GLPHCC5 GLPHCC6 GLPHCC7 GLPHCC8 GLPHCC9 GLPHCC10 GLPHCC11 GLPHCC12 GLPHCC13 GLPHCC14 GLPHCC15 GLPHCC16 GLPHCC17 GLPHCC18 GLPHCC19 GLPHCC20 GLPHCC21 GLPHCC22 GLPHCC23 GLPHCC24 GLPHCC25 GLPHCC26 GLPHCC27 GLPHCC28 GLPHCC29 GLPHCC30 GLPHCC31 GLPHCC32 GLPHCC33 GLPHCC34 GLPHCC35 GLPHCC36 GLPHCC37 GLPHCC38 GLPHCC39 GLPHCC40 GLPHCC41 GLPHCC42 GLPHCC43 GLPHCC44 GLPHD1 GLPHD2 GLPHD3 GLPHD4 GLPHD5 GLPHD6 GLPHD7 GLPHD8 GLPHD9 GLPHD10 GLPHD11 GLPHD12 GLPHD13 GLPHD14 GLPHD15 GLPHD16 GLPHD17 GLPHD18 GLPHD19 GLPHD20 GLPHD21 GLPHD22 GLPHD23 GLPHD24 GLPHD25 GLPHD26 GLPHD27 GLPHD28 GLPHD29 GLPHD30 GLPHD31 GLPHD32 GLPHD33 GLPHD34 GLPHD35 GLPHD36 GLPHD37 GLPHD38 GLPHD39 GLPHD40 GLPHD41 GLPHD42 GLPHD43 GLPHD44 GLPHD45 GLPHD46 GLPHD47 GLPHD48 GLPHD49 GLPHD50 GLPHD51 GLPHD52 GLPHD53 GLPHD54 GLPHD55 GLPHD56 GLPHD57 GLPHD58 GLPHD59 GLPHD60 GLPHD61 GLPHD62 GLPHD63 GLPHD64 GLPHD65 GLPHD66 GLPHD67 GLPHD68 GLPHD69 GLPHD70 GLPHD71 GLPHD72 GLPHD73 GLPHD74 GLPHD75 GLPHD76 GLPHD77 GLPHD78 GLPHD79 GLPHD80 GLPHD81 GLPHD82 GLPHD83 GLPHD84 GLPHD85 GLPHD86 GLPHD87 GLPHD88 GLPHD89 GLPHD90 GLPHD91 GLPHD92 GLPHD93 GLPHD94 GLPHD95 GLPHD96 GLPHD97 GLPHD98 GLPHD99 GLPHD100 GLPHD101 GLPHD102 GLPHD103 GLPHD104 GLPHD105 GLPHD106"
split_all="500000"
for split in $split_all
do
bedtools makewindows -g $Genomedir/$Genome.genome -w $split|sort -k1,1 -k2,2n> window${split}.bed
for s in $sample
do
	bedtools genomecov -bga -pc -ibam $s.uniq.nodup.bam > $s.uniq.bg
	wait
	bedtools intersect -a $s.uniq.bg -b $Genomedir/hg38.blacklist.bed -v -wa|sort -k1,1 -k2,2n> $s.blacklist.uniq.bed
	wait
	cat $s.blacklist.uniq.bed|awk -F "\t" '$4!=0{print $0}'|cut -f1-3 > $s.blacklist.uniq.nonzero.bed
	wait
	bedtools coverage -a window${split}.bed -b $s.blacklist.uniq.nonzero.bed> $s.blacklist.uniq.window${split}.bed
	wait
	bedtools coverage -a $Genomedir/CFSsMappedAtMolecularLevel_hg38Colon_withoutXLoVo.bed -b $s.blacklist.uniq.nonzero.bed> $s.blacklist.uniq.CFS.bed
done
done

prefix=".blacklist.uniq.CFS.bed"
suffix="CovInCFSs"
python3.7 ./Summary_ResultsOfSamples.py --target_bed $Genomedir/CFSsMappedAtMolecularLevel_hg38Colon_withoutXLoVo.bed --prefix $prefix --suffix $suffix --samples $sample

split="500000"
prefix=".blacklist.uniq.window${split}.bed"
suffix="CovInBins_${split}"
python3.7 ./Summary_ResultsOfSamples.py --target_bed window${split}.bed --prefix $prefix --suffix $suffix --samples $sample


